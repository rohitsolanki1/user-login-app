<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>User Login App</title>
<style>
body { font-family: Arial; display:flex; justify-content:center; align-items:center; height:100vh; gap:50px; }
form { border:1px solid #ccc; padding:20px; border-radius:5px; }
input { display:block; margin:10px 0; padding:8px; width:200px; }
button { padding:8px 16px; }
</style>
</head>
<body>

<form id="loginForm">
<h3>Login</h3>
<input type="text" id="username" placeholder="Username" required>
<input type="password" id="password" placeholder="Password" required>
<button type="submit">Login</button>
<p id="loginMessage"></p>
</form>

<form id="registerForm">
<h3>Register</h3>
<input type="text" id="regUsername" placeholder="Username" required>
<input type="password" id="regPassword" placeholder="Password" required>
<button type="submit">Register</button>
<p id="regMessage"></p>
</form>

<script>
const API_URL = '/api'; // Relative path for Ingress routing

// Login
const loginForm = document.getElementById('loginForm');
loginForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    try {
        const res = await fetch(`${API_URL}/api/login`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ username, password })
        });
        const data = await res.json();
        document.getElementById('loginMessage').innerText = res.ok 
            ? "Login Success! Token: " + data.token 
            : "Error: " + data.error;
    } catch(err) {
        document.getElementById('loginMessage').innerText = "Network error: " + err;
    }
});

// Register
const registerForm = document.getElementById('registerForm');
registerForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const username = document.getElementById('regUsername').value;
    const password = document.getElementById('regPassword').value;
    try {
        const res = await fetch(`${API_URL}/api/register`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ username, password })
        });
        const data = await res.json();
        document.getElementById('regMessage').innerText = res.ok 
            ? data.message 
            : "Error: " + data.error;
    } catch(err) {
        document.getElementById('regMessage').innerText = "Network error: " + err;
    }
});
</script>

</body>
</html>
